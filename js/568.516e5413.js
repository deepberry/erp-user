"use strict";(self["webpackChunktitan2"]=self["webpackChunktitan2"]||[]).push([[568],{9756:function(e,t,a){a.r(t),a.d(t,{default:function(){return Je}});var l=a(6252),s=a(3577);const i=e=>((0,l.dD)("data-v-2caff9b6"),e=e(),(0,l.Cn)(),e),o={class:"task inner"},d={class:"box"},n=i((()=>(0,l._)("div",{class:"head"},[(0,l._)("span",{class:"active"},"任务列表")],-1))),r={class:"ctrl"},u={class:"status"},c={class:"search"},p=(0,l.Uk)("查询"),m=i((()=>(0,l._)("i",{class:"erp erpjiufuqianbaoicon06"},null,-1))),g=(0,l.Uk)(" 创建任务"),h={class:"tableWrap"},w={class:"table"},k=(0,l.Uk)("查看详情"),v={key:0,class:"pages"},_={class:"total"};function D(e,t,a,i,D,f){const C=(0,l.up)("el-button"),y=(0,l.up)("el-badge"),x=(0,l.up)("el-input"),b=(0,l.up)("el-table-column"),T=(0,l.up)("el-table"),B=(0,l.up)("el-pagination"),U=(0,l.up)("TaskDetail"),z=(0,l.up)("TaskCreate"),W=(0,l.Q2)("loading");return(0,l.wg)(),(0,l.iD)("div",o,[(0,l._)("div",d,[n,(0,l._)("div",r,[(0,l._)("div",u,[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(D.status,(e=>((0,l.wg)(),(0,l.j4)(y,{class:"statusItem",value:e.sup>0?e.sup:"",onClick:t=>f.statusClick(e.value),key:e.value},{default:(0,l.w5)((()=>[(0,l.Wm)(C,{type:D.currentStatus==e.value?"primary":"",link:""},{default:(0,l.w5)((()=>[(0,l.Uk)((0,s.zw)(e.title),1)])),_:2},1032,["type"])])),_:2},1032,["value","onClick"])))),128))]),(0,l._)("div",c,[(0,l.Wm)(x,{modelValue:D.searchKey,"onUpdate:modelValue":t[0]||(t[0]=e=>D.searchKey=e),class:"searchInput",placeholder:"关键词搜索：任务内容、检查建议..."},null,8,["modelValue"]),(0,l.Wm)(C,{type:"primary",class:"searchSubmit",onClick:f.getData,loading:D.searchLoading},{default:(0,l.w5)((()=>[p])),_:1},8,["onClick","loading"]),e.$store.state.power.createTaskBtn?((0,l.wg)(),(0,l.j4)(C,{key:0,type:"primary",class:"searchCreateNewTask",onClick:t[1]||(t[1]=e=>D.showCreateBox=!0)},{default:(0,l.w5)((()=>[m,g])),_:1})):(0,l.kq)("",!0)])]),(0,l._)("div",h,[(0,l._)("div",w,[(0,l.wy)(((0,l.wg)(),(0,l.j4)(T,{size:"large",data:D.list,style:{width:"100%"},"max-height":"600px"},{default:(0,l.w5)((()=>[(0,l.Wm)(b,{label:"任务单号",width:"150","show-overflow-tooltip":""},{default:(0,l.w5)((e=>[(0,l.Uk)(" RW"+(0,s.zw)(e.row.id),1)])),_:1}),(0,l.Wm)(b,{label:"所属棚区",width:"300","show-overflow-tooltip":""},{default:(0,l.w5)((e=>[(0,l.Uk)((0,s.zw)(e.row.gardenTitle)+"-"+(0,s.zw)(e.row.growPlantTitle)+"-"+(0,s.zw)(e.row.address),1)])),_:1}),(0,l.Wm)(b,{label:"执行人"},{default:(0,l.w5)((e=>[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(e.row.executors,(e=>((0,l.wg)(),(0,l.iD)("p",{key:e.id},(0,s.zw)(e.name),1)))),128))])),_:1}),(0,l.Wm)(b,{prop:"taskContent",label:"任务内容"}),(0,l.Wm)(b,{label:"状态",width:"200"},{default:(0,l.w5)((e=>[(0,l._)("span",{style:(0,s.j5)({color:e.row.color})},(0,s.zw)(e.row.statusText),5)])),_:1}),(0,l.Wm)(b,{label:"操作",width:"200"},{default:(0,l.w5)((t=>[e.$store.state.power.taskDetail?((0,l.wg)(),(0,l.j4)(C,{key:0,link:"",type:"primary",onClick:e=>f.showDetail(t.row.id)},{default:(0,l.w5)((()=>[k])),_:2},1032,["onClick"])):(0,l.kq)("",!0)])),_:1})])),_:1},8,["data"])),[[W,D.loading]]),D.list.length>0?((0,l.wg)(),(0,l.iD)("div",v,[(0,l._)("span",_,"共 "+(0,s.zw)(D.total)+" 条",1),(0,l.Wm)(B,{currentPage:D.currentPage,"onUpdate:currentPage":t[2]||(t[2]=e=>D.currentPage=e),"page-size":D.pageSize,"onUpdate:page-size":t[3]||(t[3]=e=>D.pageSize=e),onCurrentChange:f.getData,background:"",layout:"prev, pager, next, jumper",total:D.total},null,8,["currentPage","page-size","onCurrentChange","total"])])):(0,l.kq)("",!0)])])]),D.showDetailBox?((0,l.wg)(),(0,l.j4)(U,{key:0,id:D.currentId,onOnCloseDetail:f.onCloseDetail},null,8,["id","onOnCloseDetail"])):(0,l.kq)("",!0),D.showCreateBox?((0,l.wg)(),(0,l.j4)(z,{key:1,onOnCloseCreate:f.onCloseCreate},null,8,["onOnCloseCreate"])):(0,l.kq)("",!0)])}var f=a(8090),C=a(7795),y=a(7913),x=a(9536);const b=e=>((0,l.dD)("data-v-1bfc7a0a"),e=e(),(0,l.Cn)(),e),T={class:"taskDetail purchaseDetailBox"},B={class:"taskDetailInner purchaseDetailBoxInner"},U={key:0,class:"statusImg",src:f,alt:""},z={key:1,class:"statusImg",src:C,alt:""},W={key:2,class:"statusImg",src:y,alt:""},V={key:3,class:"statusImg",src:x,alt:""},P={class:"id wrap"},I={class:"create wrap"},j=b((()=>(0,l._)("div",null,"任务创建",-1))),q=b((()=>(0,l._)("div",null,"任务内容",-1))),L={class:"taskContent"},S=b((()=>(0,l._)("p",null,"操作视频：",-1))),$=["src"],R=(0,l.Uk)(" 指定执行人："),Y={key:4,class:"todo wrap"},G=b((()=>(0,l._)("div",null,"任务执行",-1))),K={class:"a"},N={key:5,class:"todo wrap"},A=b((()=>(0,l._)("div",null,"任务检查",-1))),F=b((()=>(0,l._)("div",null,"检查意见：",-1))),O={class:"todoContent"},Z={style:{display:"block"}},H=b((()=>(0,l._)("i",{class:"erp erptianxie",style:{"margin-right":"5px","font-size":"12px"}},null,-1))),M=(0,l.Uk)(" 填写检查意见"),J={key:7,class:"form wrap"},Q=b((()=>(0,l._)("div",null,"填写检查意见",-1))),E=(0,l.Uk)(" 是否合格： "),X=(0,l.Uk)("合格"),ee=(0,l.Uk)("不合格"),te=(0,l.Uk)("打回"),ae={class:"formTextarea"},le=b((()=>(0,l._)("p",null,"意见建议：",-1))),se={key:8,class:"btns"},ie=(0,l.Uk)("取消"),oe=(0,l.Uk)("确定"),de={class:"btns"},ne=(0,l.Uk)("删除任务");function re(e,t,a,i,o,d){const n=(0,l.up)("el-button"),r=(0,l.up)("el-radio"),u=(0,l.up)("el-radio-group"),c=(0,l.up)("el-input"),p=(0,l.up)("el-dialog"),m=(0,l.up)("PlantCropsDetailCDialogDetail"),g=(0,l.Q2)("loading");return(0,l.wg)(),(0,l.iD)("div",T,[(0,l.Wm)(p,{"custom-class":"taskDetail purchaseDetailBox","before-close":d.onClose,"append-to-body":"",modelValue:o.showDetailBox,"onUpdate:modelValue":t[6]||(t[6]=e=>o.showDetailBox=e),title:"任务详情",width:"700px"},{default:(0,l.w5)((()=>[(0,l.wy)(((0,l.wg)(),(0,l.iD)("div",B,[0==o.detail.status?((0,l.wg)(),(0,l.iD)("img",U)):(0,l.kq)("",!0),1==o.detail.status?((0,l.wg)(),(0,l.iD)("img",z)):(0,l.kq)("",!0),2==o.detail.status?((0,l.wg)(),(0,l.iD)("img",W)):(0,l.kq)("",!0),3==o.detail.status?((0,l.wg)(),(0,l.iD)("img",V)):(0,l.kq)("",!0),(0,l._)("div",P,"任务单号：RW"+(0,s.zw)(o.detail.id),1),(0,l._)("div",I,[j,(0,l._)("div",null,[(0,l._)("p",null,"创建人："+(0,s.zw)(o.detail.createUserName),1),(0,l._)("p",null,"创建时间："+(0,s.zw)(o.detail.createTime),1)]),q,(0,l._)("div",L,[(0,l._)("div",null,[(0,l._)("p",null,"园区："+(0,s.zw)(o.detail.gardenTitle),1),(0,l._)("p",null,"作物："+(0,s.zw)(o.detail.growPlantTitle)+"-"+(0,s.zw)(o.detail.address),1)]),(0,l._)("div",null,[(0,l._)("p",null,"内容："+(0,s.zw)(o.detail.taskContent),1),(0,l._)("div",null,[S,o.detail.reWire?((0,l.wg)(),(0,l.iD)("video",{key:0,controls:"",onClick:t[0]||(t[0]=e=>d.view(o.detail.reWire)),src:o.detail.reWire,alt:""},null,8,$)):(0,l.kq)("",!0)])])]),(0,l._)("div",null,[(0,l._)("p",null,[R,((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(o.detail.executors,(e=>((0,l.wg)(),(0,l.iD)("span",{style:{margin:"0 5px"},key:e.id},(0,s.zw)(e.name),1)))),128))])]),(0,l._)("div",null,"开始时间："+(0,s.zw)(o.detail.startTime),1),(0,l._)("div",null,"截止时间："+(0,s.zw)(o.detail.endTime),1)]),0!=o.detail.status?((0,l.wg)(),(0,l.iD)("div",Y,[G,(0,l._)("div",null,"执行提交时间："+(0,s.zw)(o.detail.farmRecordBo.workTime),1),(0,l._)("div",null,"执行提交人："+(0,s.zw)(o.detail.farmRecordBo.userName),1),(0,l._)("div",{class:"todoContent",onClick:t[1]||(t[1]=(...e)=>d.showDetailClick&&d.showDetailClick(...e))},[(0,l._)("div",null,[(0,l._)("p",K,(0,s.zw)(o.detail.farmRecordBo.title),1),(0,l._)("p",null,(0,s.zw)(o.detail.farmRecordBo.workTime),1)]),(0,l._)("div",null,[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(o.detail.farmRecordBo.farmUseBos,(e=>((0,l.wg)(),(0,l.iD)("p",{class:"u",key:e.id},(0,s.zw)(e.agricultural)+"      "+(0,s.zw)(e.agriculturalCount)+" "+(0,s.zw)(e.agriculturalUnit),1)))),128))]),(0,l._)("div",null,[(0,l._)("p",null,(0,s.zw)(o.detail.farmRecordBo.workText||"无备注"),1),(0,l._)("p",null,(0,s.zw)(o.detail.farmRecordBo.userName),1)])])])):(0,l.kq)("",!0),o.detail.status>1&&e.$store.state.power.checkTaskBtn?((0,l.wg)(),(0,l.iD)("div",N,[A,(0,l._)("div",null,"检查结果："+(0,s.zw)([0,0,"合格","不合格","打回"][o.detail.status]),1),F,(0,l._)("div",O,[(0,l._)("div",Z,(0,s.zw)(o.detail.opinion),1)])])):(0,l.kq)("",!0),o.showTextArea||1!=o.detail.status?(0,l.kq)("",!0):((0,l.wg)(),(0,l.j4)(n,{key:6,onClick:t[2]||(t[2]=e=>o.showTextArea=!0),type:"primary",link:"",style:{"margin-top":"20px"}},{default:(0,l.w5)((()=>[H,M])),_:1})),o.showTextArea?((0,l.wg)(),(0,l.iD)("div",J,[Q,(0,l._)("div",null,[(0,l._)("div",null,[E,(0,l.Wm)(u,{modelValue:o.isPass,"onUpdate:modelValue":t[3]||(t[3]=e=>o.isPass=e),class:"ml-4"},{default:(0,l.w5)((()=>[(0,l.Wm)(r,{label:"2"},{default:(0,l.w5)((()=>[X])),_:1}),(0,l.Wm)(r,{label:"3"},{default:(0,l.w5)((()=>[ee])),_:1}),(0,l.Wm)(r,{label:"4"},{default:(0,l.w5)((()=>[te])),_:1})])),_:1},8,["modelValue"])])]),(0,l._)("div",ae,[le,(0,l.Wm)(c,{modelValue:o.textarea,"onUpdate:modelValue":t[4]||(t[4]=e=>o.textarea=e),rows:5,type:"textarea",placeholder:"输入检查意见"},null,8,["modelValue"])])])):(0,l.kq)("",!0),o.showTextArea?((0,l.wg)(),(0,l.iD)("div",se,[(0,l.Wm)(n,{type:"primary",plain:"",onClick:t[5]||(t[5]=e=>o.showTextArea=!1)},{default:(0,l.w5)((()=>[ie])),_:1}),(0,l.Wm)(n,{type:"primary",onClick:d.submitCheck,loading:o.submitting},{default:(0,l.w5)((()=>[oe])),_:1},8,["onClick","loading"])])):(0,l.kq)("",!0),(0,l._)("div",de,[(0,l.Wm)(n,{type:"primary",plain:"",onClick:d.delTask},{default:(0,l.w5)((()=>[ne])),_:1},8,["onClick"])])])),[[g,o.detailLoading]])])),_:1},8,["before-close","modelValue"]),o.showDetail?((0,l.wg)(),(0,l.j4)(m,{key:0,title:o.detailTitle,id:o.detailId,onClose:d.closeDetail,onLoad:d.getData},null,8,["title","id","onClose","onLoad"])):(0,l.kq)("",!0)])}var ue=a(5320),ce=a(2335),pe={name:"taskDetail",props:["id"],data(){return{detailLoading:!1,showDetailBox:!0,detail:{farmRecordBo:{farmUseBos:[]}},showTextArea:!1,textarea:"",isPass:"2",submitting:!1,showDetail:!1,detailTitle:"",detailId:""}},components:{PlantCropsDetailCDialogDetail:ue.Z},mounted(){this.getData()},methods:{delTask(){this.ajax.post("/api/v1/adam/task/deleteTask",{taskId:this.detail.id}).then((e=>{this.$message.success("删除成功"),this.onClose(1)}))},showDetailClick(e){this.detailTitle="农事记录详情",this.detailId=this.detail.farmRecordBo.id,this.showDetail=!0},view(e){window.open(e)},closeDetail(){setTimeout((()=>{this.showDetail=!1}),300)},getData(){this.detailLoading=!0,this.ajax.post("/api/v1/adam/task/taskDetail",{taskId:this.id}).then((e=>{this.detailLoading=!1,e.data.startTime=ce.Z.time("y-m-d h:i:s",e.data.startTime),e.data.endTime=ce.Z.time("y-m-d h:i:s",e.data.endTime),e.data.createTime=ce.Z.time("y-m-d h:i:s",e.data.createTime),e.data.executors=JSON.parse(e.data.executors),e.data.farmRecordBo=e.data.farmRecordBo||{farmUseBos:{}},e.data.farmRecordBo.farmUseBos=e.data.farmRecordBo.farmUseBos||{},this.detail=e.data}))},onClose(e=null){"function"==typeof e&&(e=null),this.$emit("onCloseDetail",e),this.showDetailBox=!1},submitCheck(){this.submitting=!0,this.ajax.post("/api/v1/adam/task/taskCheck",{checkStatus:this.isPass,taskId:this.id,taskOpinion:this.textarea}).then((e=>{this.submitting=!1,this.$message.success("提交成功"),this.onClose(1)}))}}},me=a(8118);const ge=(0,me.Z)(pe,[["render",re],["__scopeId","data-v-1bfc7a0a"]]);var he=ge;const we=e=>((0,l.dD)("data-v-651844c0"),e=e(),(0,l.Cn)(),e),ke={class:"taskDetail purchaseDetailBox"},ve={class:"taskDetailInner purchaseDetailBoxInner"},_e={class:"item"},De=we((()=>(0,l._)("p",{class:"title"},"园区：",-1))),fe={class:"item"},Ce=we((()=>(0,l._)("p",{class:"title"},"作物：",-1))),ye={class:"item"},xe=we((()=>(0,l._)("p",{class:"title"},"具体内容：",-1))),be={class:"item"},Te=we((()=>(0,l._)("p",{class:"title"},"操作指导：",-1))),Be={class:"upload"},Ue=["src"],ze={key:2,class:"uploadBox"},We={key:1},Ve=we((()=>(0,l._)("i",{class:"erp erpshangchuan"},null,-1))),Pe=[Ve],Ie={key:2},je={class:"item"},qe=we((()=>(0,l._)("p",{class:"title"},"执行人：",-1))),Le={class:"item"},Se=we((()=>(0,l._)("p",{class:"title"},"开始时间：",-1))),$e={class:"item"},Re=we((()=>(0,l._)("p",{class:"title"},"截止时间：",-1))),Ye={class:"btns"},Ge=(0,l.Uk)("取消"),Ke=(0,l.Uk)("确定");function Ne(e,t,a,s,i,o){const d=(0,l.up)("el-option"),n=(0,l.up)("el-select"),r=(0,l.up)("el-input"),u=(0,l.up)("el-progress"),c=(0,l.up)("el-date-picker"),p=(0,l.up)("el-button"),m=(0,l.up)("el-dialog"),g=(0,l.Q2)("loading");return(0,l.wg)(),(0,l.iD)("div",ke,[(0,l.Wm)(m,{"custom-class":"taskDetail purchaseDetailBox","before-close":o.onClose,"append-to-body":"",modelValue:i.showDetailBox,"onUpdate:modelValue":t[8]||(t[8]=e=>i.showDetailBox=e),title:"创建任务",width:"700px"},{default:(0,l.w5)((()=>[(0,l.wy)(((0,l.wg)(),(0,l.iD)("div",ve,[(0,l._)("div",_e,[De,(0,l.Wm)(n,{modelValue:i.selectedGarden,"onUpdate:modelValue":t[0]||(t[0]=e=>i.selectedGarden=e),style:{width:"650px"},class:"m-2",placeholder:"请选择园区"},{default:(0,l.w5)((()=>[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(i.gardenList,((e,t)=>((0,l.wg)(),(0,l.j4)(d,{key:t,label:e.title,value:e.id},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])]),(0,l._)("div",fe,[Ce,(0,l.Wm)(n,{modelValue:i.selectedPlant,"onUpdate:modelValue":t[1]||(t[1]=e=>i.selectedPlant=e),multiple:"",style:{width:"650px"},class:"m-2",placeholder:"请选择作物"},{default:(0,l.w5)((()=>[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(i.plantList,((e,t)=>((0,l.wg)(),(0,l.j4)(d,{key:t,label:e.categoryTitle+"-"+e.address,value:e.id},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])]),(0,l._)("div",ye,[xe,(0,l.Wm)(r,{modelValue:i.taskContent,"onUpdate:modelValue":t[2]||(t[2]=e=>i.taskContent=e),style:{width:"650px"},placeholder:"请输入内容"},null,8,["modelValue"])]),(0,l._)("div",be,[Te,(0,l._)("div",Be,[i.video?((0,l.wg)(),(0,l.iD)("video",{key:0,controls:"",src:i.video,alt:""},null,8,Ue)):(0,l.kq)("",!0),i.video?((0,l.wg)(),(0,l.iD)("i",{key:1,class:"erp erpguanbi",onClick:t[3]||(t[3]=e=>i.video="")})):(0,l.kq)("",!0),i.video?(0,l.kq)("",!0):((0,l.wg)(),(0,l.iD)("div",ze,[i.uploading?(0,l.kq)("",!0):((0,l.wg)(),(0,l.iD)("input",{key:0,onChange:t[4]||(t[4]=(...e)=>o.uploadFile&&o.uploadFile(...e)),ref:"file",type:"file"},null,544)),i.uploading?(0,l.kq)("",!0):((0,l.wg)(),(0,l.iD)("p",We,Pe)),i.uploading?(0,l.kq)("",!0):((0,l.wg)(),(0,l.iD)("p",Ie,"点击上传视频")),i.uploading?((0,l.wg)(),(0,l.j4)(u,{key:3,width:90,type:"circle",percentage:i.percentage},null,8,["percentage"])):(0,l.kq)("",!0)]))])]),(0,l._)("div",je,[qe,(0,l.Wm)(n,{modelValue:i.selectedUser,"onUpdate:modelValue":t[5]||(t[5]=e=>i.selectedUser=e),multiple:"",style:{width:"650px"},class:"m-2",placeholder:"请选择执行人"},{default:(0,l.w5)((()=>[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(i.userlist,((e,t)=>((0,l.wg)(),(0,l.j4)(d,{key:t,label:e.name,value:e.id},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])]),(0,l._)("div",Le,[Se,(0,l.Wm)(c,{"value-format":"YYYY-MM-DD",style:{width:"650px"},modelValue:i.startTime,"onUpdate:modelValue":t[6]||(t[6]=e=>i.startTime=e),type:"date",placeholder:"请选择开始时间"},null,8,["modelValue"])]),(0,l._)("div",$e,[Re,(0,l.Wm)(c,{style:{width:"650px"},"value-format":"YYYY-MM-DD",modelValue:i.endTime,"onUpdate:modelValue":t[7]||(t[7]=e=>i.endTime=e),type:"date",placeholder:"请选择截止时间"},null,8,["modelValue"])])])),[[g,i.detailLoading]]),(0,l._)("div",Ye,[(0,l.Wm)(p,{plain:"",onClick:o.onClose},{default:(0,l.w5)((()=>[Ge])),_:1},8,["onClick"]),(0,l.Wm)(p,{type:"primary",onClick:o.submit,loading:i.submitting},{default:(0,l.w5)((()=>[Ke])),_:1},8,["onClick","loading"])])])),_:1},8,["before-close","modelValue"])])}var Ae=a(3483),Fe={name:"taskDetail",props:["id"],data(){return{detailLoading:!1,showDetailBox:!0,detail:"",showTextArea:!1,textarea:"",isPass:"1",selectedGarden:"",selectedPlant:[],selectedUser:[],gardenList:[],plantList:[],userlist:[],taskContent:"",startTime:"",endTime:"",video:"",uploading:!1,percentage:0,searchCropLoading:!1,submitting:!1}},mounted(){let e=this,t=async function(){await e.getGardenList(),await e.getUserlist()};t()},watch:{selectedGarden(){this.plantList=[],this.selectedPlant="",this.ajax.post("/api/v1/adam/task/getPlantsByGarden",{gardenId:this.selectedGarden}).then((e=>{console.log(e.data),this.plantList=e.data}))}},methods:{getGardenList(){return new Promise(((e,t)=>{this.ajax.post("/api/v1/adam/garden/list",{pageNum:1,pageSize:100,param:{}}).then((t=>{this.gardenList=t.data,e()}))}))},getUserlist(){return new Promise(((e,t)=>{this.ajax.post("/api/v1/adam/task/getOrganizationUsers",{pageNum:1,pageSize:100,param:{}}).then((t=>{this.userlist=t.data,e()}))}))},onClose(e=null){"function"==typeof e&&(e=null),this.$emit("onCloseCreate",e),this.showDetailBox=!1},uploadFile(){this.uploading=!0;let e=this.$refs.file.files[0];(0,Ae.Z)(e,`erp/park/${e.name}`).then((e=>{e.url&&(this.video=e.url,this.uploading=!1,this.percentage=0)}))},searchCrop(){},submit(){let e="";if(this.gardenList.map((t=>{t.id==this.selectedGarden&&(e=t.title)})),!this.selectedGarden)return void this.$message.warning("请选择园区");if(0==this.selectedPlant.length)return void this.$message.warning("请选择作物");if(!this.taskContent)return void this.$message.warning("请输入具体内容");if(0==this.selectedUser.length)return void this.$message.warning("请选择执行人");if(!this.startTime)return void this.$message.warning("请选择开始时间");if(!this.endTime)return void this.$message.warning("请选择截止时间");let t=this.selectedUser.map((e=>{let t={id:"",name:""};return this.userlist.map((a=>{e==a.id&&(t.id=a.id,t.name=a.name)})),t}));this.submitting=!0,this.ajax.post("/api/v1/adam/task/createTask",{endTime:this.endTime,executors:JSON.stringify(t),gardenId:this.selectedGarden,gardenTitle:e,growPlants:this.selectedPlant,opinion:"",reWire:this.video,startTime:this.startTime,taskContent:this.taskContent}).then((e=>{this.submitting=!1,200==e.code&&1==e.data?(this.onClose(1),this.showDetailBox=!1):this.$message.error(e.message)}))}}};const Oe=(0,me.Z)(Fe,[["render",Ne],["__scopeId","data-v-651844c0"]]);var Ze=Oe,He={name:"task",data(){return{status:[{title:"全部",value:"-1",sup:0},{title:"待执行",value:"0",sup:0},{title:"待检查",value:"1",sup:0},{title:"合格",value:"2",sup:0},{title:"不合格",value:"3",sup:0}],loading:!1,currentStatus:"-1",searchKey:"",searchLoading:!1,list:[],currentPage:1,pageSize:10,total:0,showDetailBox:!1,showCreateBox:!1,currentId:""}},components:{TaskDetail:he,TaskCreate:Ze},mounted(){this.getData(),this.getStatus_1()},methods:{statusClick(e){this.currentStatus=e,this.getData()},getStatus_1(){this.ajax.post("/api/v1/adam/task/manageTaskList",{pageNum:this.currentPage,pageSize:10,param:{gardenId:"",growPlantId:"",status:1,keyWord:""}}).then((e=>{this.status[2].sup=e.total}))},getData(){this.loading=!0,this.ajax.post("/api/v1/adam/task/manageTaskList",{pageNum:this.currentPage,pageSize:10,param:{gardenId:-1,growPlantId:-1,status:this.currentStatus,keyWord:this.searchKey}}).then((e=>{this.list=e.data.map((e=>{switch(e.executors=JSON.parse(e.executors),e.status){case 0:e.statusText="待执行",e.color="#A8A8A8";break;case 1:e.statusText="待检查",e.color="#1890FF";break;case 2:e.statusText="合格",e.color="#0DD71C";break;case 3:e.statusText="不合格",e.color="#FF4949";break;case 4:e.statusText="打回",e.color="#FF4949";break}return e})),this.total=e.total,this.loading=!1}))},showDetail(e){this.currentId=e,this.showDetailBox=!0},onCloseDetail(e){1==e&&this.getData();let t=setTimeout((()=>{this.showDetailBox=!1,clearTimeout(t)}),500)},onCloseCreate(e){1==e&&this.getData(),console.log(e);let t=setTimeout((()=>{this.showCreateBox=!1,clearTimeout(t)}),500)}}};const Me=(0,me.Z)(He,[["render",D],["__scopeId","data-v-2caff9b6"]]);var Je=Me},8090:function(e,t,a){e.exports=a.p+"img/0.b107b999.png"},7795:function(e,t,a){e.exports=a.p+"img/1.a4a41189.png"},7913:function(e,t,a){e.exports=a.p+"img/2.16b2581e.png"},9536:function(e,t,a){e.exports=a.p+"img/3.6bfbb5bf.png"}}]);
//# sourceMappingURL=568.516e5413.js.map