"use strict";(self["webpackChunktitan2"]=self["webpackChunktitan2"]||[]).push([[162],{2895:function(e,t,l){l.d(t,{Z:function(){return H}});var a=l(6252),i=l(3577),s=l(9963);const r=e=>((0,a.dD)("data-v-4d539890"),e=e(),(0,a.Cn)(),e),u={class:"main"},o={class:"tab"},n={class:"tabbox tab1"},d=["onClick"],c={class:"itemBox"},m={class:"tag"},g=(0,a.Uk)(" 使用量："),p={class:"btn"},h=(0,a.Uk)("    取消    "),w=(0,a.Uk)("    确定    "),y={class:"tabbox tab2"},v={class:"item"},f=r((()=>(0,a._)("div",{class:"title"},[(0,a._)("span",null,"*"),(0,a.Uk)(" 农资名称：")],-1))),_={class:"content"},k={class:"item"},C=r((()=>(0,a._)("div",{class:"title"},[(0,a._)("span",null,"*"),(0,a.Uk)(" 农资类型：")],-1))),b={class:"content"},U={class:"contentA"},D={key:0,class:"contentB"},V={class:"item"},B=r((()=>(0,a._)("div",{class:"title"},[(0,a._)("span",null,"*"),(0,a.Uk)(" 使用量：")],-1))),x={class:"content"},$={class:"contentA"},N={class:"contentB"},T={class:"item"},z=r((()=>(0,a._)("div",{class:"title"},"厂家：",-1))),j={class:"content"},I={class:"btn"},q=(0,a.Uk)("保存并继续添加"),A=(0,a.Uk)("    保存    ");function E(e,t,l,r,E,M){const W=(0,a.up)("el-empty"),F=(0,a.up)("el-input"),H=(0,a.up)("el-button"),S=(0,a.up)("el-option"),K=(0,a.up)("el-select"),Y=(0,a.up)("el-dialog");return(0,a.wg)(),(0,a.j4)(Y,{"before-close":M.onClose,"append-to-body":"",modelValue:E.showDetailBox,"onUpdate:modelValue":t[10]||(t[10]=e=>E.showDetailBox=e),title:"添加农资",width:"740px"},{default:(0,a.w5)((()=>[(0,a._)("div",u,[(0,a._)("div",o,[(0,a._)("span",{class:(0,i.C_)(0==E.tab?"active":""),onClick:t[0]||(t[0]=e=>E.tab=0)},"选择已领取农资",2),(0,a._)("span",{class:(0,i.C_)(1==E.tab?"active":""),onClick:t[1]||(t[1]=e=>E.tab=1)},"手动输入农资信息",2)]),(0,a.wy)((0,a._)("div",n,[0==E.list.length?((0,a.wg)(),(0,a.j4)(W,{key:0,description:"暂无数据"})):(0,a.kq)("",!0),((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(E.list,((e,t)=>((0,a.wg)(),(0,a.iD)("div",{class:"item",key:e.id},[(0,a._)("i",{onClick:t=>e.use=!e.use,class:(0,i.C_)(e.use||e.selected?"erp erpduoxuankuangxuanzhong":"erp erpduoxuan-01")},null,10,d),(0,a._)("div",c,[(0,a._)("div",null,[(0,a._)("span",null,[(0,a.Uk)((0,i.zw)(e.agriculturalBo.title)+" ",1),(0,a._)("span",m,(0,i.zw)(e.agriculturalBo.agriculturalCategory),1)]),(0,a._)("span",null,"("+(0,i.zw)(e.agriculturalBo.agriculturalCount)+(0,i.zw)(e.agriculturalBo.unitweight)+"/"+(0,i.zw)(e.agriculturalBo.unitmeasurement)+")",1),(0,a._)("span",null,(0,i.zw)(e.agriculturalBo.manufacturers),1)]),(0,a._)("div",null,[(0,a._)("span",null," 库存量： "+(0,i.zw)(e.agriculturalUnit)+(0,i.zw)(e.agriculturalBo.unitmeasurement)+"（共"+(0,i.zw)(e.agriculturalCount)+(0,i.zw)(e.agriculturalBo.unitweight)+"） ",1),(0,a._)("div",null,[g,(0,a.Wm)(F,{style:{width:"160px"},onBlur:l=>e.useNum>e.agriculturalCount?M.inputNum(t):()=>{},modelValue:e.useNum,"onUpdate:modelValue":t=>e.useNum=t,placeholder:"输入数量"},{append:(0,a.w5)((()=>[(0,a.Uk)((0,i.zw)(e.agriculturalBo.unitweight),1)])),_:2},1032,["onBlur","modelValue","onUpdate:modelValue"])])])])])))),128)),(0,a._)("div",p,[(0,a.Wm)(H,{type:"primary",plain:"",onClick:M.onClose},{default:(0,a.w5)((()=>[h])),_:1},8,["onClick"]),(0,a.Wm)(H,{type:"primary",onClick:M.chose},{default:(0,a.w5)((()=>[w])),_:1},8,["onClick"])])],512),[[s.F8,0==E.tab]]),(0,a.wy)((0,a._)("div",y,[(0,a._)("div",v,[f,(0,a._)("div",_,[(0,a.Wm)(F,{modelValue:E.title,"onUpdate:modelValue":t[2]||(t[2]=e=>E.title=e),placeholder:"请输入"},null,8,["modelValue"])])]),(0,a._)("div",k,[C,(0,a._)("div",b,[(0,a._)("div",U,[(0,a.Wm)(K,{style:{width:"100%"},modelValue:E.currentAgriculturalCategory,"onUpdate:modelValue":t[3]||(t[3]=e=>E.currentAgriculturalCategory=e),placeholder:"请选择农资类型"},{default:(0,a.w5)((()=>[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(E.agriculturalCategory,(e=>((0,a.wg)(),(0,a.j4)(S,{key:e.id,label:e.title,value:e.id},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])]),-1==E.currentAgriculturalCategory?((0,a.wg)(),(0,a.iD)("div",D,[(0,a.Wm)(F,{modelValue:E.diyAgriculturalCategory,"onUpdate:modelValue":t[4]||(t[4]=e=>E.diyAgriculturalCategory=e),placeholder:"请输入"},null,8,["modelValue"])])):(0,a.kq)("",!0)])]),(0,a._)("div",V,[B,(0,a._)("div",x,[(0,a._)("div",$,[(0,a.Wm)(F,{modelValue:E.useNum,"onUpdate:modelValue":t[5]||(t[5]=e=>E.useNum=e),placeholder:"请输入使用量"},null,8,["modelValue"])]),(0,a._)("div",N,[(0,a.Wm)(K,{style:{width:"100%"},modelValue:E.currentUnitMeasurement,"onUpdate:modelValue":t[6]||(t[6]=e=>E.currentUnitMeasurement=e),placeholder:"单位"},{default:(0,a.w5)((()=>[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(E.unitMeasurement,(e=>((0,a.wg)(),(0,a.j4)(S,{key:e.id,label:e.title,value:e.id},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])])]),(0,a._)("div",T,[z,(0,a._)("div",j,[(0,a.Wm)(F,{modelValue:E.company,"onUpdate:modelValue":t[7]||(t[7]=e=>E.company=e),placeholder:"请输入厂家"},null,8,["modelValue"])])]),(0,a._)("div",I,[(0,a.Wm)(H,{type:"primary",plain:"",onClick:t[8]||(t[8]=e=>M.save(0))},{default:(0,a.w5)((()=>[q])),_:1}),(0,a.Wm)(H,{type:"primary",onClick:t[9]||(t[9]=e=>M.save(1))},{default:(0,a.w5)((()=>[A])),_:1})])],512),[[s.F8,1==E.tab]])])])),_:1},8,["before-close","modelValue"])}var M={props:["id","selected"],emits:["close","save","chose"],data(){return{showDetailBox:!0,tab:0,list:[],title:"",agriculturalCategory:[],currentAgriculturalCategory:"",diyAgriculturalCategory:"",unitMeasurement:[],currentUnitMeasurement:"",useNum:"",company:""}},mounted(){this.getAgriculturalUser(),this.getAgriculturalCategory(),this.getUnitMeasurement()},methods:{inputNum(e){this.$message.warning("库存不足"),this.list[e].useNum=""},chose(){let e=[],t=null;this.list.map((l=>{l.use&&(l.useNum?e.push(l):t=l)})),t?this.$message.warning(`请输入[${t.agriculturalBo.title}]的使用数量`):(e=e.map((e=>({agriculturalType:e.agriculturalBo.agriculturalCategory,agricultural:e.agriculturalBo.title,agriculturalId:e.agriculturalBo.id,agriculturalCount:e.useNum,agriculturalUnit:e.agriculturalBo.unitweight,definition:0,agriculturalUnitId:e.agriculturalBo.unitweightid,isUse:0,manufacturers:e.agriculturalBo.manufacturers}))),this.$emit("chose",e),this.onClose())},save(e){let t={agricultural:this.title,agriculturalId:"",agriculturalCount:this.useNum,agriculturalUnit:"",definition:1,agriculturalUnitId:this.currentUnitMeasurement,isUse:0,manufacturers:this.company};this.unitMeasurement.map((e=>{e.id==this.currentUnitMeasurement&&(t.agriculturalUnit=e.title)})),t.agricultural?this.currentAgriculturalCategory?-1!=this.currentAgriculturalCategory||this.diyAgriculturalCategory?t.agriculturalCount?(-1==this.currentAgriculturalCategory?(t.agriculturalType=this.diyAgriculturalCategory,t.id=""):(t.id=this.currentAgriculturalCategory,this.agriculturalCategory.map((e=>{e.id==t.id&&(t.agriculturalType=e.title)}))),this.$emit("save",t),1==e?this.onClose():(this.title="",this.currentAgriculturalCategory="",this.useNum="",this.company="")):this.$message.warning("请输入使用量"):this.$message.warning("请输入农资类型"):this.$message.warning("请选择农资类型"):this.$message.warning("请输入农资标题")},onClose(e=null){"function"==typeof e&&(e=null),this.$emit("close",e),this.showDetailBox=!1},getUnitMeasurement(){this.ajax.post("/api/v1/adam/farm/getWeightUnit").then((e=>{this.unitMeasurement=e.data,this.currentUnitMeasurement=e.data[0].id}))},getAgriculturalCategory(){this.ajax.post("/api/v1/adam/farm/getAgriculturalCategory").then((e=>{this.agriculturalCategory=e.data,this.agriculturalCategory.unshift({id:-1,title:"自定义"})}))},getAgriculturalUser(){this.ajax.post("/api/v1/adam/farmLand/agriculturalUser-list",{pageNum:1,pageSize:100,param:{endTime:"",id:0,keyWord:"",startTime:""}}).then((e=>{this.list=e.data.map((e=>(this.selected&&this.selected.map((t=>{console.log(t),e.agriculturalBo.id==t.agriculturalId&&(e.selected=!0,e.useNum=t.agriculturalCount,e.use=!0)})),e)))}))}}},W=l(8118);const F=(0,W.Z)(M,[["render",E],["__scopeId","data-v-4d539890"]]);var H=F},5320:function(e,t,l){l.d(t,{Z:function(){return fe}});var a=l(6252),i=l(3577);const s=e=>((0,a.dD)("data-v-6b237ceb"),e=e(),(0,a.Cn)(),e),r={class:"btn"},u={class:"form"},o={class:"item"},n=s((()=>(0,a._)("p",{class:"title"},"种植植物：",-1))),d={class:"content"},c={class:"text"},m={class:"item"},g=s((()=>(0,a._)("p",{class:"title"},"农事类型：",-1))),p={class:"content"},h={class:"item"},w={key:0,class:"title"},y={key:1,class:"content"},v=s((()=>(0,a._)("p",{class:"text"},"暂无数据",-1))),f=[v],_={key:2,class:"title"},k={key:3,class:"content"},C=(0,a.Uk)("公斤"),b={key:4,class:"content nz"},U={class:"tag"},D=["onClick"],V=s((()=>(0,a._)("i",{class:"erp erpicon_tianjia"},null,-1))),B=(0,a.Uk)(" 添加农资 "),x=[V,B],$={class:"item"},N=s((()=>(0,a._)("p",{class:"title"},"工时：",-1))),T={class:"content"},z={class:"item"},j=s((()=>(0,a._)("p",{class:"title"},"作业方式：",-1))),I={class:"content"},q={class:"item"},A=s((()=>(0,a._)("p",{class:"title"},"操作时间：",-1))),E={class:"content"},M={class:"item"},W=s((()=>(0,a._)("p",{class:"title"},"操作人：",-1))),F={class:"content"},H={class:"item"},S=s((()=>(0,a._)("p",{class:"title"},"农事照片：",-1))),K={key:0,class:"content"},Y=["onClick","src"],L={key:0,class:"text"},O={key:1,class:"content"},R={class:"pics"},Z=["src"],P=["onClick"],J={key:0,class:"upload"},G={key:1},Q=s((()=>(0,a._)("i",{class:"erp erpshangchuan"},null,-1))),X=[Q],ee={key:2},te={class:"item itemBig"},le=s((()=>(0,a._)("p",{class:"title"},"备注：",-1))),ae={class:"content"},ie={class:"item itemBig"},se=s((()=>(0,a._)("p",{class:"title"},"环境数据：",-1))),re={class:"content hj",style:{width:"460px"}},ue=["src"],oe={key:0,class:"text"},ne={class:"item itemBig"},de=s((()=>(0,a._)("p",{class:"title"},"现场照片：",-1))),ce={class:"content hj",style:{width:"460px"}},me=s((()=>(0,a._)("p",{class:"text"},"暂无数据",-1)));function ge(e,t,l,s,v,V){const B=(0,a.up)("el-button"),Q=(0,a.up)("el-option"),ge=(0,a.up)("el-select"),pe=(0,a.up)("el-input"),he=(0,a.up)("el-date-picker"),we=(0,a.up)("el-progress"),ye=(0,a.up)("PlantCropsDetailBDialogChose"),ve=(0,a.up)("el-dialog");return(0,a.wg)(),(0,a.j4)(ve,{modelValue:v.dialogVisible,"onUpdate:modelValue":t[9]||(t[9]=e=>v.dialogVisible=e),title:l.title,width:"580px","before-close":V.handleClose,"append-to-body":""},{default:(0,a.w5)((()=>[(0,a._)("div",r,[e.$store.state.power.editFarmRecordBtn?((0,a.wg)(),(0,a.j4)(B,{key:0,type:"primary",onClick:V.editButton},{default:(0,a.w5)((()=>[(0,a.Uk)((0,i.zw)(v.isEdit?"保存":"编辑"),1)])),_:1},8,["onClick"])):(0,a.kq)("",!0),e.$store.state.power.delFarmRecordBtn?((0,a.wg)(),(0,a.j4)(B,{key:1,type:"primary",plain:"",onClick:V.del},{default:(0,a.w5)((()=>[(0,a.Uk)((0,i.zw)(v.isEdit?"取消":"删除"),1)])),_:1},8,["onClick"])):(0,a.kq)("",!0)]),(0,a._)("div",u,[(0,a._)("div",o,[n,(0,a._)("div",d,[(0,a._)("p",c,(0,i.zw)(v.form.categoryTitle+"-"+v.form.address),1)])]),(0,a._)("div",m,[g,(0,a._)("div",p,[(0,a.Wm)(ge,{disabled:!v.isEdit,style:{width:"100%"},modelValue:v.form.farmId,"onUpdate:modelValue":t[0]||(t[0]=e=>v.form.farmId=e),placeholder:"请选择农事类型"},{default:(0,a.w5)((()=>[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(v.farmType,(e=>((0,a.wg)(),(0,a.j4)(Q,{key:e.id,label:e.title,value:e.id},null,8,["label","value"])))),128))])),_:1},8,["disabled","modelValue"])])]),(0,a._)("div",h,["采摘"!=v.form.title?((0,a.wg)(),(0,a.iD)("p",w,"使用农资：")):(0,a.kq)("",!0),0!=v.form.farmUseBos.length||v.isEdit||"采摘"==v.form.title?(0,a.kq)("",!0):((0,a.wg)(),(0,a.iD)("div",y,f)),"采摘"==v.form.title?((0,a.wg)(),(0,a.iD)("p",_,"采摘重量：")):(0,a.kq)("",!0),"采摘"==v.form.title?((0,a.wg)(),(0,a.iD)("div",k,[(0,a.Wm)(pe,{disabled:!v.isEdit,modelValue:v.form.pickCount,"onUpdate:modelValue":t[1]||(t[1]=e=>v.form.pickCount=e),placeholder:"输入采摘重量"},{append:(0,a.w5)((()=>[C])),_:1},8,["disabled","modelValue"])])):(0,a.kq)("",!0),v.form.farmUseBos.length>0||v.isEdit&&"采摘"!=v.form.title?((0,a.wg)(),(0,a.iD)("div",b,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(v.form.farmUseBos,((e,t)=>((0,a.wg)(),(0,a.iD)("div",{class:"nzItem",key:e.id},[(0,a._)("div",{class:"nzBox",style:(0,i.j5)({width:v.isEdit?"400px":"438px"})},[(0,a._)("span",null,[(0,a._)("span",U,(0,i.zw)(e.agriculturalType),1)]),(0,a._)("span",null,(0,i.zw)(e.agricultural),1),(0,a._)("span",null,(0,i.zw)(e.agriculturalCount)+(0,i.zw)(e.agriculturalUnit),1)],4),v.isEdit?((0,a.wg)(),(0,a.iD)("i",{key:0,class:"erp erpshanchu",onClick:e=>V.removeNz(t)},null,8,D)):(0,a.kq)("",!0)])))),128)),v.isEdit&&"采摘"!=v.form.title?((0,a.wg)(),(0,a.iD)("div",{key:0,class:"nzAdd",onClick:t[2]||(t[2]=e=>v.showChose=!0)},x)):(0,a.kq)("",!0)])):(0,a.kq)("",!0)]),(0,a._)("div",$,[N,(0,a._)("div",T,[(0,a.Wm)(pe,{disabled:!v.isEdit,modelValue:v.form.workHour,"onUpdate:modelValue":t[3]||(t[3]=e=>v.form.workHour=e),placeholder:"请输入工时"},null,8,["disabled","modelValue"])])]),(0,a._)("div",z,[j,(0,a._)("div",I,[(0,a.Wm)(ge,{disabled:!v.isEdit,style:{width:"100%"},modelValue:v.form.workType,"onUpdate:modelValue":t[4]||(t[4]=e=>v.form.workType=e),placeholder:"请选择作业方式"},{default:(0,a.w5)((()=>[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(v.operatingType,(e=>((0,a.wg)(),(0,a.j4)(Q,{key:e.id,label:e.title,value:e.id},null,8,["label","value"])))),128))])),_:1},8,["disabled","modelValue"])])]),(0,a._)("div",q,[A,(0,a._)("div",E,[(0,a.Wm)(he,{disabled:!v.isEdit,style:{width:"100%"},modelValue:v.form.workTime,"onUpdate:modelValue":t[5]||(t[5]=e=>v.form.workTime=e),type:"date",placeholder:"请选择操作时间"},null,8,["disabled","modelValue"])])]),(0,a._)("div",M,[W,(0,a._)("div",F,[(0,a.Wm)(pe,{disabled:!v.isEdit,modelValue:v.form.userName,"onUpdate:modelValue":t[6]||(t[6]=e=>v.form.userName=e),placeholder:"请输入操作人"},null,8,["disabled","modelValue"])])]),(0,a._)("div",H,[S,v.isEdit?(0,a.kq)("",!0):((0,a.wg)(),(0,a.iD)("div",K,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(v.form.image,((e,t)=>((0,a.wg)(),(0,a.iD)("img",{class:"picsimg",onClick:t=>V.viewImg(e),key:t,src:e,alt:""},null,8,Y)))),128)),0==v.form.image.length?((0,a.wg)(),(0,a.iD)("p",L,"暂无数据")):(0,a.kq)("",!0)])),v.isEdit?((0,a.wg)(),(0,a.iD)("div",O,[(0,a._)("div",R,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(v.form.image,((e,t)=>((0,a.wg)(),(0,a.iD)("div",{class:"img",key:t},[(0,a._)("img",{src:e,alt:""},null,8,Z),(0,a._)("i",{class:"erp erpguanbi",onClick:e=>V.removeImg(t)},null,8,P)])))),128)),v.form.image.length<2?((0,a.wg)(),(0,a.iD)("div",J,[v.uploading?(0,a.kq)("",!0):((0,a.wg)(),(0,a.iD)("input",{key:0,onChange:t[7]||(t[7]=(...e)=>V.uploadFile&&V.uploadFile(...e)),ref:"file",type:"file"},null,544)),v.uploading?(0,a.kq)("",!0):((0,a.wg)(),(0,a.iD)("p",G,X)),v.uploading?(0,a.kq)("",!0):((0,a.wg)(),(0,a.iD)("p",ee,"点击上传照片")),v.uploading?((0,a.wg)(),(0,a.j4)(we,{key:3,width:90,type:"circle",percentage:v.percentage},null,8,["percentage"])):(0,a.kq)("",!0)])):(0,a.kq)("",!0)])])):(0,a.kq)("",!0)]),(0,a._)("div",te,[le,(0,a._)("div",ae,[(0,a.Wm)(pe,{disabled:!v.isEdit,modelValue:v.form.workText,"onUpdate:modelValue":t[8]||(t[8]=e=>v.form.workText=e),placeholder:"请输入备注"},null,8,["disabled","modelValue"])])]),(0,a._)("div",ie,[se,(0,a._)("div",re,[(0,a._)("div",{class:"hjbox",style:(0,i.j5)({width:150*v.form.smartDevice.length+"px"})},[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(v.form.smartDevice,(e=>((0,a.wg)(),(0,a.iD)("div",{class:"huanjing",key:e.id},[(0,a._)("img",{src:V.getIconUrl(e.icon),alt:""},null,8,ue),(0,a._)("p",null,(0,i.zw)(e.value||" ")+(0,i.zw)(e.unit||" "),1),(0,a._)("p",null,(0,i.zw)(e.displayName),1)])))),128))],4),0==v.form.smartDevice.length?((0,a.wg)(),(0,a.iD)("p",oe,"暂无数据")):(0,a.kq)("",!0)])]),(0,a._)("div",ne,[de,(0,a._)("div",ce,[(0,a.kq)("",!0),me])])]),v.showChose?((0,a.wg)(),(0,a.j4)(ye,{key:0,onSave:V.save,onChose:V.chose,onClose:V.closeChose},null,8,["onSave","onChose","onClose"])):(0,a.kq)("",!0)])),_:1},8,["modelValue","title","before-close"])}var pe=l(3483),he=l(2895),we={props:["title","id"],emits:["load","success","close"],data(){return{dialogVisible:!0,searchKey:"",list:[],imgs:[],form:{image:[],farmUseBos:[],smartDevice:[]},farmType:[],operatingType:[],isEdit:!1,uploading:!1,percentage:0,showChose:!1}},components:{PlantCropsDetailBDialogChose:he.Z},mounted(){let e=this,t=async function(){await e.getData(),await e.getFarmType(),await e.getOperatingType(),await e.getFarmRecordImg()};t()},computed:{imgSpace(){let e=0;return e=4-this.imgs.length%4,e}},methods:{viewImg(e){this.$nextTick((()=>{window.open(e)}))},getFarmRecordImg(){this.ajax.post("/api/v1/adam/task/getFarmRecordImg",{growPlantId:this.$route.query.id}).then((e=>{let t=[];e.data.map((e=>{e=e.split(","),t=[...t,...e]})),this.imgs=t}))},editButton(){if(this.isEdit){let e=JSON.parse(JSON.stringify(this.form));e.smartDevice=JSON.stringify(e.smartDevice),e.image=e.image.join(","),this.ajax.post("/api/v1/adam/farm/editeFarm",e).then((e=>{200==e.code?(this.$message.success("保存成功"),this.isEdit=!1,this.$emit("load")):this.$message.error("编辑失败，请稍后再试")}))}else this.isEdit=!0},closeChose(){setTimeout((()=>{this.showChose=!1}),300)},removeNz(e){this.form.farmUseBos.splice(e,1)},getIconUrl(e){return`https://cdn.deepberry.cn/img/common/node-props/${e||"default"}.svg`},chose(e){console.log(e);let t=[...this.form.farmUseBos,...e].map((e=>(e.agriculturalCount=Number(e.agriculturalCount),e)));var l=function(e){for(var t=[],l=[],a=0;a<e.length;a++)l.indexOf(e[a].agricultural)>-1?t[l.indexOf(e[a].agricultural)].agriculturalCount+=e[a].agriculturalCount:(l.push(e[a].agricultural),t.push(e[a]));return t};this.form.farmUseBos=l(t)},save(e){this.form.farmUseBos.push(e)},removeImg(e){console.log(e),this.form.image.splice(e,1)},uploadFile(){this.uploading=!0;let e=this.$refs.file.files[0];(0,pe.Z)(e,`erp/farmingHistory/${e.name}`).then((e=>{e.url&&(this.form.image.push(e.url),this.uploading=!1,this.percentage=0)}))},del(){this.isEdit?(this.isEdit=!1,this.getData()):this.ajax.post("/api/v1/adam/farm/delFarmRecordById",{id:this.id}).then((e=>{200==e.code?(this.$message.success("删除成功"),this.handleClose(),this.$emit("load")):this.$message.error(e.message)}))},handleClose(){this.dialogVisible=!1,this.$emit("close")},getData(){return new Promise(((e,t)=>{this.ajax.post("/api/v1/adam/farm/getFarmRecordById",{id:this.id}).then((t=>{t.data.image=t.data.image.length>0?t.data.image.split(","):[],t.data.smartDevice=JSON.parse(t.data.smartDevice)||[],this.form=t.data,console.log(this.form),e()}))}))},getFarmType(){return new Promise(((e,t)=>{this.ajax.post("/api/v1/adam/farm/getFarmType").then((t=>{this.farmType=t.data,e()}))}))},getOperatingType(){return new Promise(((e,t)=>{this.ajax.post("/api/v1/adam/farm/getOperatingType").then((t=>{this.operatingType=t.data,e()}))}))}}},ye=l(8118);const ve=(0,ye.Z)(we,[["render",ge],["__scopeId","data-v-6b237ceb"]]);var fe=ve},2335:function(e,t){const l={to2:e=>Number(e)<10?`0${Number(e)}`:String(e),time(e="y-m-d",t=null){let l=t?new Date(t):new Date;return e=e.replace("y",l.getFullYear()),e=e.replace("m",this.to2(l.getMonth()+1)),e=e.replace("d",this.to2(l.getDate())),e=e.replace("h",this.to2(l.getHours())),e=e.replace("i",this.to2(l.getMinutes())),e=e.replace("s",this.to2(l.getSeconds())),e=e.replace("w",l.getDay()),e},monthLength(e=null){let t=1*this.time("y",e),l=this.to2(1*this.time("m",e)+1);if(13==l)return 31;{let e=new Date(`${t}-${l}-01`).getTime()-864e5;return Number(this.time("d",e))}},preMonthLenggth(e=null){let t=1*this.time("y",e),l=this.to2(1*this.time("m",e)),a=new Date(`${t}-${l}-01`).getTime()-864e5;return Number(this.time("d",a))},nextMonthLenggth(e=null){let t=1*this.time("y",e),l=this.to2(1*this.time("m",e)+2),a=new Date(`${t}-${l}-01`).getTime()-864e5;return Number(this.time("d",a))},monthFirst(e=null){let t=this.time("y-m",e)+"-01";return this.time("y-m-d",t)},monthLast(e=null){let t=1*this.time("y",e),l=this.to2(1*this.time("m",e)+1),a=new Date(`${t}-${l}-01`).getTime()-864e5;return this.time("y-m-d",a)},preMonthToday(e=null){let t=Number(e.substr(0,4)),l=Number(e.substr(5,2)),a=Number(e.substr(8));return a>this.preMonthLenggth(`{y}-${l}-01`)&&(a=this.preMonthLenggth(`{y}-${l}-01`)),1==l?(t-=1,l=12):l-=1,`${t}-${l}-${a}`},nextMonthToday(e=null){let t=Number(e.substr(0,4)),l=Number(e.substr(5,2)),a=Number(e.substr(8));return a>this.nextMonthLenggth(`{y}-${l}-01`)&&(a=this.nextMonthLenggth(`{y}-${l}-01`)),12==l?(t+=1,l=1):l+=1,`${t}-${l}-${a}`},timeout(e){},timeRemaining(e,t){return t-=parseInt((new Date).getTime()/1e3),this.unixToString(e,t)},unixToString(e,t){let a=parseInt(t/60/60/24),i=parseInt((t-86400*a)/3600),s=parseInt((t-86400*a-3600*i)/60),r=t-86400*a-3600*i-60*s;return e=e.replace("d",l.to2(l.low(a))),e=e.replace("h",l.to2(l.low(i))),e=e.replace("i",l.to2(l.low(s))),e=e.replace("s",l.to2(l.low(r))),e},low(e){return e<0?0:e},parse(e){return new Date(e)}};t["Z"]=l}}]);
//# sourceMappingURL=162.e585c638.js.map