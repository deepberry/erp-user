"use strict";(self["webpackChunktitan2"]=self["webpackChunktitan2"]||[]).push([[231],{7987:function(e,t,l){l.d(t,{Z:function(){return c}});var a=l(6252);const i={style:{"margin-top":"20px"}},s={style:{"margin-top":"20px","text-align":"center"}},o=(0,a.Uk)("保存"),r=(0,a.Uk)("保存并继续添加");function n(e,t,l,n,u,d){const m=(0,a.up)("el-input"),c=(0,a.up)("el-button"),p=(0,a.up)("el-dialog");return(0,a.wg)(),(0,a.j4)(p,{"before-close":d.onClose,"append-to-body":"",modelValue:u.showBox,"onUpdate:modelValue":t[2]||(t[2]=e=>u.showBox=e),title:u.title,width:"400px"},{default:(0,a.w5)((()=>[(0,a._)("div",null,[(0,a.Wm)(m,{modelValue:u.name,"onUpdate:modelValue":t[0]||(t[0]=e=>u.name=e),placeholder:"请输入名称"},null,8,["modelValue"])]),(0,a._)("div",i,[(0,a.Wm)(m,{modelValue:u.num,"onUpdate:modelValue":t[1]||(t[1]=e=>u.num=e),placeholder:"请输入数量"},null,8,["modelValue"])]),(0,a._)("div",s,[(0,a.Wm)(c,{type:"primary",onClick:d.save},{default:(0,a.w5)((()=>[o])),_:1},8,["onClick"]),(0,a.Wm)(c,{type:"primary",text:"",onClick:d.save2},{default:(0,a.w5)((()=>[r])),_:1},8,["onClick"])])])),_:1},8,["before-close","modelValue","title"])}var u={props:["type"],data(){return{showBox:!0,title:"",name:"",num:""}},mounted(){this.title="添加"+(1==this.type?"虫子":"天敌")},methods:{save(){let e=this.save2();e&&this.$emit("close")},save2(){return console.log(this.type),this.name?this.num?(this.$emit("save",{type:this.type,name:this.name,num:this.num}),this.name="",this.num="",!0):(this.$message.error("请输入数量"),!1):(this.$message.error("请输入名称"),!1)},onClose(){this.showBox=!1,this.$emit("close")}}},d=l(8118);const m=(0,d.Z)(u,[["render",n]]);var c=m},8618:function(e,t,l){l.d(t,{Z:function(){return M}});var a=l(6252),i=l(3577),s=l(9963);const o=e=>((0,a.dD)("data-v-0c29a38a"),e=e(),(0,a.Cn)(),e),r={class:"main"},n={class:"tab"},u={class:"tabbox tab1"},d=["onClick"],m={class:"itemBox"},c={class:"tag"},p=(0,a.Uk)(" 使用量："),g={class:"btn"},h=(0,a.Uk)("    取消    "),w=(0,a.Uk)("    确定    "),y={class:"tabbox tab2"},f={class:"item"},v=o((()=>(0,a._)("div",{class:"title"},[(0,a._)("span",null,"*"),(0,a.Uk)(" 农资名称：")],-1))),_={class:"content"},k={class:"item"},D=o((()=>(0,a._)("div",{class:"title"},[(0,a._)("span",null,"*"),(0,a.Uk)(" 农资类型：")],-1))),C={class:"content"},B={class:"contentA"},b={key:0,class:"contentB"},U={class:"item"},V=o((()=>(0,a._)("div",{class:"title"},[(0,a._)("span",null,"*"),(0,a.Uk)(" 使用量：")],-1))),x={class:"content"},$={class:"contentA"},z={class:"contentB"},T={class:"item"},L=o((()=>(0,a._)("div",{class:"title"},"厂家：",-1))),N={class:"content"},j={class:"btn"},I=(0,a.Uk)("保存并继续添加"),E=(0,a.Uk)("    保存    ");function q(e,t,l,o,q,A){const P=(0,a.up)("el-empty"),W=(0,a.up)("el-input"),M=(0,a.up)("el-button"),F=(0,a.up)("el-option"),H=(0,a.up)("el-select"),S=(0,a.up)("el-dialog");return(0,a.wg)(),(0,a.j4)(S,{"before-close":A.onClose,"append-to-body":"",modelValue:q.showDetailBox,"onUpdate:modelValue":t[10]||(t[10]=e=>q.showDetailBox=e),title:"添加农资",width:"740px"},{default:(0,a.w5)((()=>[(0,a._)("div",r,[(0,a._)("div",n,[(0,a._)("span",{class:(0,i.C_)(0==q.tab?"active":""),onClick:t[0]||(t[0]=e=>q.tab=0)},"选择已领取农资",2),(0,a._)("span",{class:(0,i.C_)(1==q.tab?"active":""),onClick:t[1]||(t[1]=e=>q.tab=1)},"手动输入农资信息",2)]),(0,a.wy)((0,a._)("div",u,[0==q.list.length?((0,a.wg)(),(0,a.j4)(P,{key:0,description:"暂无数据"})):(0,a.kq)("",!0),((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(q.list,((e,t)=>((0,a.wg)(),(0,a.iD)("div",{class:"item",key:e.id},[(0,a._)("i",{onClick:t=>e.use=!e.use,class:(0,i.C_)(e.use||e.selected?"erp erpduoxuankuangxuanzhong":"erp erpduoxuan-01")},null,10,d),(0,a._)("div",m,[(0,a._)("div",null,[(0,a._)("span",null,[(0,a.Uk)((0,i.zw)(e.agriculturalBo.title)+" ",1),(0,a._)("span",c,(0,i.zw)(e.agriculturalBo.agriculturalCategory),1)]),(0,a._)("span",null,"("+(0,i.zw)(e.agriculturalBo.agriculturalCount)+(0,i.zw)(e.agriculturalBo.unitweight)+"/"+(0,i.zw)(e.agriculturalBo.unitmeasurement)+")",1),(0,a._)("span",null,(0,i.zw)(e.agriculturalBo.manufacturers),1)]),(0,a._)("div",null,[(0,a._)("span",null," 库存量： "+(0,i.zw)(e.agriculturalUnit)+(0,i.zw)(e.agriculturalBo.unitmeasurement)+"（共"+(0,i.zw)(e.agriculturalCount)+(0,i.zw)(e.agriculturalBo.unitweight)+"） ",1),(0,a._)("div",null,[p,(0,a.Wm)(W,{style:{width:"160px"},onBlur:l=>e.useNum>e.agriculturalCount?A.inputNum(t):()=>{},modelValue:e.useNum,"onUpdate:modelValue":t=>e.useNum=t,placeholder:"输入数量"},{append:(0,a.w5)((()=>[(0,a.Uk)((0,i.zw)(e.agriculturalBo.unitweight),1)])),_:2},1032,["onBlur","modelValue","onUpdate:modelValue"])])])])])))),128)),(0,a._)("div",g,[(0,a.Wm)(M,{type:"primary",plain:"",onClick:A.onClose},{default:(0,a.w5)((()=>[h])),_:1},8,["onClick"]),(0,a.Wm)(M,{type:"primary",onClick:A.chose},{default:(0,a.w5)((()=>[w])),_:1},8,["onClick"])])],512),[[s.F8,0==q.tab]]),(0,a.wy)((0,a._)("div",y,[(0,a._)("div",f,[v,(0,a._)("div",_,[(0,a.Wm)(W,{modelValue:q.title,"onUpdate:modelValue":t[2]||(t[2]=e=>q.title=e),placeholder:"请输入"},null,8,["modelValue"])])]),(0,a._)("div",k,[D,(0,a._)("div",C,[(0,a._)("div",B,[(0,a.Wm)(H,{style:{width:"100%"},modelValue:q.currentAgriculturalCategory,"onUpdate:modelValue":t[3]||(t[3]=e=>q.currentAgriculturalCategory=e),placeholder:"请选择农资类型"},{default:(0,a.w5)((()=>[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(q.agriculturalCategory,(e=>((0,a.wg)(),(0,a.j4)(F,{key:e.id,label:e.title,value:e.id},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])]),-1==q.currentAgriculturalCategory?((0,a.wg)(),(0,a.iD)("div",b,[(0,a.Wm)(W,{modelValue:q.diyAgriculturalCategory,"onUpdate:modelValue":t[4]||(t[4]=e=>q.diyAgriculturalCategory=e),placeholder:"请输入"},null,8,["modelValue"])])):(0,a.kq)("",!0)])]),(0,a._)("div",U,[V,(0,a._)("div",x,[(0,a._)("div",$,[(0,a.Wm)(W,{modelValue:q.useNum,"onUpdate:modelValue":t[5]||(t[5]=e=>q.useNum=e),placeholder:"请输入使用量"},null,8,["modelValue"])]),(0,a._)("div",z,[(0,a.Wm)(H,{style:{width:"100%"},modelValue:q.currentUnitMeasurement,"onUpdate:modelValue":t[6]||(t[6]=e=>q.currentUnitMeasurement=e),placeholder:"单位"},{default:(0,a.w5)((()=>[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(q.unitMeasurement,(e=>((0,a.wg)(),(0,a.j4)(F,{key:e.id,label:e.title,value:e.id},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])])]),(0,a._)("div",T,[L,(0,a._)("div",N,[(0,a.Wm)(W,{modelValue:q.company,"onUpdate:modelValue":t[7]||(t[7]=e=>q.company=e),placeholder:"请输入厂家"},null,8,["modelValue"])])]),(0,a._)("div",j,[(0,a.Wm)(M,{type:"primary",plain:"",onClick:t[8]||(t[8]=e=>A.save(0))},{default:(0,a.w5)((()=>[I])),_:1}),(0,a.Wm)(M,{type:"primary",onClick:t[9]||(t[9]=e=>A.save(1))},{default:(0,a.w5)((()=>[E])),_:1})])],512),[[s.F8,1==q.tab]])])])),_:1},8,["before-close","modelValue"])}var A={props:["id","selected","neednum"],emits:["close","save","chose"],data(){return{showDetailBox:!0,tab:0,list:[],title:"",agriculturalCategory:[],currentAgriculturalCategory:"",diyAgriculturalCategory:"",unitMeasurement:[],currentUnitMeasurement:"",useNum:"",company:""}},mounted(){this.getAgriculturalUser(),this.getAgriculturalCategory(),this.getUnitMeasurement()},methods:{inputNum(e){this.$message.warning("库存不足"),this.list[e].useNum=""},chose(){let e=[],t=null;"no"!=this.neednum&&(this.list.map((l=>{l.use&&(l.useNum?e.push(l):t=l)})),t)?this.$message.warning(`请输入[${t.agriculturalBo.title}]的使用数量`):("no"==this.neednum&&this.list.map((t=>{t.use&&e.push(t)})),e=e.map((e=>({agriculturalType:e.agriculturalBo.agriculturalCategory,agricultural:e.agriculturalBo.title,agriculturalId:e.agriculturalBo.id,agriculturalCount:e.useNum,agriculturalUnit:e.agriculturalBo.unitweight,definition:0,agriculturalUnitId:e.agriculturalBo.unitweightid,isUse:0,manufacturers:e.agriculturalBo.manufacturers}))),console.log(e),this.$emit("chose",e),this.onClose())},save(e){let t={agricultural:this.title,agriculturalId:"",agriculturalCount:this.useNum,agriculturalUnit:"",definition:1,agriculturalUnitId:this.currentUnitMeasurement,isUse:0,manufacturers:this.company};this.unitMeasurement.map((e=>{e.id==this.currentUnitMeasurement&&(t.agriculturalUnit=e.title)})),t.agricultural?this.currentAgriculturalCategory?-1!=this.currentAgriculturalCategory||this.diyAgriculturalCategory?t.agriculturalCount?(-1==this.currentAgriculturalCategory?(t.agriculturalType=this.diyAgriculturalCategory,t.id=""):(t.id=this.currentAgriculturalCategory,this.agriculturalCategory.map((e=>{e.id==t.id&&(t.agriculturalType=e.title)}))),this.$emit("save",t),1==e?this.onClose():(this.title="",this.currentAgriculturalCategory="",this.useNum="",this.company="")):this.$message.warning("请输入使用量"):this.$message.warning("请输入农资类型"):this.$message.warning("请选择农资类型"):this.$message.warning("请输入农资标题")},onClose(e=null){"function"==typeof e&&(e=null),this.$emit("close",e),this.showDetailBox=!1},getUnitMeasurement(){this.ajax.post("/api/v1/adam/farm/getWeightUnit").then((e=>{this.unitMeasurement=e.data,this.currentUnitMeasurement=e.data[0].id}))},getAgriculturalCategory(){this.ajax.post("/api/v1/adam/farm/getAgriculturalCategory").then((e=>{this.agriculturalCategory=e.data,this.agriculturalCategory.unshift({id:-1,title:"自定义"})}))},getAgriculturalUser(){this.ajax.post("/api/v1/adam/farmLand/agriculturalUser-list",{pageNum:1,pageSize:100,param:{endTime:"",id:0,keyWord:"",startTime:""}}).then((e=>{this.list=e.data.map((e=>(this.selected&&this.selected.map((t=>{console.log(t),e.agriculturalBo.id==t.agriculturalId&&(e.selected=!0,e.useNum=t.agriculturalCount,e.use=!0)})),e)))}))}}},P=l(8118);const W=(0,P.Z)(A,[["render",q],["__scopeId","data-v-0c29a38a"]]);var M=W},6571:function(e,t,l){l.d(t,{Z:function(){return Se}});var a=l(6252),i=l(3577);const s=e=>((0,a.dD)("data-v-3080dee8"),e=e(),(0,a.Cn)(),e),o={class:"btn"},r={class:"form"},n={class:"item"},u=s((()=>(0,a._)("p",{class:"title"},"种植植物：",-1))),d={class:"content"},m={class:"text"},c={class:"item"},p=s((()=>(0,a._)("p",{class:"title"},"农事类型：",-1))),g={class:"content"},h={key:0,class:"item",style:{"margin-top":"5px"}},w=s((()=>(0,a._)("p",{class:"title"},null,-1))),y={class:"content nz"},f={class:"tag"},v=s((()=>(0,a._)("span",null,"虫子",-1))),_=["onClick"],k={class:"tag"},D=s((()=>(0,a._)("span",null,"天敌",-1))),C=["onClick"],B=s((()=>(0,a._)("i",{class:"erp erpicon_tianjia"},null,-1))),b=(0,a.Uk)(" 添加虫子 "),U=[B,b],V=s((()=>(0,a._)("i",{class:"erp erpicon_tianjia"},null,-1))),x=(0,a.Uk)(" 添加天敌 "),$=[V,x],z={key:1,class:"item",style:{"margin-top":"5px"}},T=s((()=>(0,a._)("p",{class:"title"},null,-1))),L={class:"content nz"},N={class:"nzItem"},j={key:0,class:"nzBox",style:{width:"438px"}},I={key:1,class:"nzBox"},E=(0,a.Uk)("厘米"),q=(0,a.Uk)("个"),A={key:2,class:"item"},P=s((()=>(0,a._)("p",{class:"title"},"采摘重量：",-1))),W={class:"content"},M=(0,a.Uk)("公斤"),F={class:"item"},H=s((()=>(0,a._)("p",{class:"title"},"使用农资：",-1))),S={key:0,class:"content"},K=s((()=>(0,a._)("p",{class:"text"},"暂无数据",-1))),Y=[K],Z={key:1,class:"content nz"},O={class:"tag"},G=["onClick"],R=s((()=>(0,a._)("i",{class:"erp erpicon_tianjia"},null,-1))),J=(0,a.Uk)(" 添加农资 "),Q=[R,J],X={class:"item"},ee=s((()=>(0,a._)("p",{class:"title"},"工时：",-1))),te={class:"content"},le={class:"item"},ae=s((()=>(0,a._)("p",{class:"title"},"作业方式：",-1))),ie={class:"content"},se={class:"item"},oe=s((()=>(0,a._)("p",{class:"title"},"操作时间：",-1))),re={class:"content"},ne={class:"item"},ue=s((()=>(0,a._)("p",{class:"title"},"操作人：",-1))),de={class:"content"},me={class:"item"},ce=s((()=>(0,a._)("p",{class:"title"},"农事照片：",-1))),pe={key:0,class:"content"},ge=["onClick","src"],he={key:0,class:"text"},we={key:1,class:"content"},ye={class:"pics"},fe=["src"],ve=["onClick"],_e={key:0,class:"upload"},ke={key:1},De=s((()=>(0,a._)("i",{class:"erp erpshangchuan"},null,-1))),Ce=[De],Be={key:2},be={class:"item itemBig"},Ue=s((()=>(0,a._)("p",{class:"title"},"备注：",-1))),Ve={class:"content"},xe={class:"item itemBig"},$e=s((()=>(0,a._)("p",{class:"title"},"环境数据：",-1))),ze={class:"content hj",style:{width:"460px"}},Te=["src"],Le={key:0,class:"text"},Ne={class:"item itemBig"},je=s((()=>(0,a._)("p",{class:"title"},"现场照片：",-1))),Ie={class:"content hj",style:{width:"460px"}},Ee=s((()=>(0,a._)("p",{class:"text"},"暂无数据",-1)));function qe(e,t,l,s,B,b){const V=(0,a.up)("el-button"),x=(0,a.up)("el-option"),K=(0,a.up)("el-select"),R=(0,a.up)("el-input"),J=(0,a.up)("el-date-picker"),De=(0,a.up)("el-progress"),qe=(0,a.up)("PlantCropsDetailBDialogChose"),Ae=(0,a.up)("PlantCropsDetailBDialogAddPests"),Pe=(0,a.up)("el-dialog");return(0,a.wg)(),(0,a.j4)(Pe,{modelValue:B.dialogVisible,"onUpdate:modelValue":t[14]||(t[14]=e=>B.dialogVisible=e),title:l.title,width:"580px","before-close":b.handleClose,"append-to-body":""},{default:(0,a.w5)((()=>[(0,a._)("div",o,[e.$store.state.power.editFarmRecordBtn?((0,a.wg)(),(0,a.j4)(V,{key:0,type:"primary",onClick:b.editButton},{default:(0,a.w5)((()=>[(0,a.Uk)((0,i.zw)(B.isEdit?"保存":"编辑"),1)])),_:1},8,["onClick"])):(0,a.kq)("",!0),e.$store.state.power.delFarmRecordBtn?((0,a.wg)(),(0,a.j4)(V,{key:1,type:"primary",plain:"",onClick:b.del},{default:(0,a.w5)((()=>[(0,a.Uk)((0,i.zw)(B.isEdit?"取消":"删除"),1)])),_:1},8,["onClick"])):(0,a.kq)("",!0)]),(0,a._)("div",r,[(0,a._)("div",n,[u,(0,a._)("div",d,[(0,a._)("p",m,(0,i.zw)(B.form.categoryTitle+"-"+B.form.address),1)])]),(0,a._)("div",c,[p,(0,a._)("div",g,[(0,a.Wm)(K,{disabled:!B.isEdit,style:{width:"100%"},modelValue:B.form.farmId,"onUpdate:modelValue":t[0]||(t[0]=e=>B.form.farmId=e),placeholder:"请选择农事类型"},{default:(0,a.w5)((()=>[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(B.farmType,(e=>((0,a.wg)(),(0,a.j4)(x,{key:e.id,label:e.title,value:e.id},null,8,["label","value"])))),128))])),_:1},8,["disabled","modelValue"])])]),16==B.form.farmId?((0,a.wg)(),(0,a.iD)("div",h,[w,(0,a._)("div",y,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(B.form.farmDetailBo.farmDetailListChongBoList,((e,t)=>((0,a.wg)(),(0,a.iD)("div",{class:"nzItem",key:e.id},[(0,a._)("div",{class:"nzBox",style:(0,i.j5)({width:B.isEdit?"400px":"438px"})},[(0,a._)("span",null,[(0,a._)("span",f,(0,i.zw)(e.title),1)]),v,(0,a._)("span",null,(0,i.zw)(e.count)+"只",1)],4),B.isEdit?((0,a.wg)(),(0,a.iD)("i",{key:0,class:"erp erpshanchu",onClick:e=>b.removePests(t,1)},null,8,_)):(0,a.kq)("",!0)])))),128)),((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(B.form.farmDetailBo.farmDetailListTianBoList,((e,t)=>((0,a.wg)(),(0,a.iD)("div",{class:"nzItem",key:e.id},[(0,a._)("div",{class:"nzBox",style:(0,i.j5)({width:B.isEdit?"400px":"438px"})},[(0,a._)("span",null,[(0,a._)("span",k,(0,i.zw)(e.title),1)]),D,(0,a._)("span",null,(0,i.zw)(e.count)+"只",1)],4),B.isEdit?((0,a.wg)(),(0,a.iD)("i",{key:0,class:"erp erpshanchu",onClick:e=>b.removePests(t,0)},null,8,C)):(0,a.kq)("",!0)])))),128)),B.isEdit&&"采摘"!=B.form.title?((0,a.wg)(),(0,a.iD)("div",{key:0,class:"nzAdd",onClick:t[1]||(t[1]=e=>b.addPests(1))},U)):(0,a.kq)("",!0),B.isEdit&&"采摘"!=B.form.title?((0,a.wg)(),(0,a.iD)("div",{key:1,class:"nzAdd",style:{"border-top":"1px solid rgba(0, 0, 0, 0.05)"},onClick:t[2]||(t[2]=e=>b.addPests(0))},$)):(0,a.kq)("",!0)])])):(0,a.kq)("",!0),17==B.form.farmId?((0,a.wg)(),(0,a.iD)("div",z,[T,(0,a._)("div",L,[(0,a._)("div",N,[B.isEdit?(0,a.kq)("",!0):((0,a.wg)(),(0,a.iD)("div",j,[(0,a._)("span",null,"观测点："+(0,i.zw)(B.form.farmDetailBo.title),1),(0,a._)("span",null,(0,i.zw)(B.form.farmDetailBo.farmDetailListGrowBoList[0].title)+"厘米",1),(0,a._)("span",null,(0,i.zw)(B.form.farmDetailBo.farmDetailListGrowBoList[0].count)+"个节点",1)])),B.isEdit?((0,a.wg)(),(0,a.iD)("div",I,[(0,a.Wm)(R,{modelValue:B.form.farmDetailBo.title,"onUpdate:modelValue":t[3]||(t[3]=e=>B.form.farmDetailBo.title=e),placeholder:"监测点",style:{width:"35%"}},null,8,["modelValue"]),(0,a.Wm)(R,{style:{width:"35%"},modelValue:B.form.farmDetailBo.farmDetailListGrowBoList[0].title,"onUpdate:modelValue":t[4]||(t[4]=e=>B.form.farmDetailBo.farmDetailListGrowBoList[0].title=e),placeholder:"株高"},{append:(0,a.w5)((()=>[E])),_:1},8,["modelValue"]),(0,a.Wm)(R,{style:{width:"30%"},modelValue:B.form.farmDetailBo.farmDetailListGrowBoList[0].count,"onUpdate:modelValue":t[5]||(t[5]=e=>B.form.farmDetailBo.farmDetailListGrowBoList[0].count=e),placeholder:"节点数"},{append:(0,a.w5)((()=>[q])),_:1},8,["modelValue"])])):(0,a.kq)("",!0)])])])):(0,a.kq)("",!0),13==B.form.farmId?((0,a.wg)(),(0,a.iD)("div",A,[P,(0,a._)("div",W,[(0,a.Wm)(R,{disabled:!B.isEdit,modelValue:B.form.pickCount,"onUpdate:modelValue":t[6]||(t[6]=e=>B.form.pickCount=e),placeholder:"输入采摘重量"},{append:(0,a.w5)((()=>[M])),_:1},8,["disabled","modelValue"])])])):(0,a.kq)("",!0),(0,a._)("div",F,[H,0!=B.form.farmUseBos.length||B.isEdit?(0,a.kq)("",!0):((0,a.wg)(),(0,a.iD)("div",S,Y)),B.form.farmUseBos.length>0||B.isEdit?((0,a.wg)(),(0,a.iD)("div",Z,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(B.form.farmUseBos,((e,t)=>((0,a.wg)(),(0,a.iD)("div",{class:"nzItem",key:e.id},[(0,a._)("div",{class:"nzBox",style:(0,i.j5)({width:B.isEdit?"400px":"438px"})},[(0,a._)("span",null,[(0,a._)("span",O,(0,i.zw)(e.agriculturalType),1)]),(0,a._)("span",null,(0,i.zw)(e.agricultural),1),(0,a._)("span",null,(0,i.zw)(e.agriculturalCount)+(0,i.zw)(e.agriculturalUnit),1)],4),B.isEdit?((0,a.wg)(),(0,a.iD)("i",{key:0,class:"erp erpshanchu",onClick:e=>b.removeNz(t)},null,8,G)):(0,a.kq)("",!0)])))),128)),B.isEdit?((0,a.wg)(),(0,a.iD)("div",{key:0,class:"nzAdd",onClick:t[7]||(t[7]=e=>B.showChose=!0)},Q)):(0,a.kq)("",!0)])):(0,a.kq)("",!0)]),(0,a._)("div",X,[ee,(0,a._)("div",te,[(0,a.Wm)(R,{disabled:!B.isEdit,modelValue:B.form.workHour,"onUpdate:modelValue":t[8]||(t[8]=e=>B.form.workHour=e),placeholder:"请输入工时"},null,8,["disabled","modelValue"])])]),(0,a._)("div",le,[ae,(0,a._)("div",ie,[(0,a.Wm)(K,{disabled:!B.isEdit,style:{width:"100%"},modelValue:B.form.workType,"onUpdate:modelValue":t[9]||(t[9]=e=>B.form.workType=e),placeholder:"请选择作业方式"},{default:(0,a.w5)((()=>[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(B.operatingType,(e=>((0,a.wg)(),(0,a.j4)(x,{key:e.id,label:e.title,value:e.id},null,8,["label","value"])))),128))])),_:1},8,["disabled","modelValue"])])]),(0,a._)("div",se,[oe,(0,a._)("div",re,[(0,a.Wm)(J,{disabled:!B.isEdit,style:{width:"100%"},modelValue:B.form.workTime,"onUpdate:modelValue":t[10]||(t[10]=e=>B.form.workTime=e),type:"date",placeholder:"请选择操作时间"},null,8,["disabled","modelValue"])])]),(0,a._)("div",ne,[ue,(0,a._)("div",de,[(0,a.Wm)(R,{disabled:!B.isEdit,modelValue:B.form.userName,"onUpdate:modelValue":t[11]||(t[11]=e=>B.form.userName=e),placeholder:"请输入操作人"},null,8,["disabled","modelValue"])])]),(0,a._)("div",me,[ce,B.isEdit?(0,a.kq)("",!0):((0,a.wg)(),(0,a.iD)("div",pe,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(B.form.image,((e,t)=>((0,a.wg)(),(0,a.iD)("img",{class:"picsimg",onClick:t=>b.viewImg(e),key:t,src:e,alt:""},null,8,ge)))),128)),0==B.form.image.length?((0,a.wg)(),(0,a.iD)("p",he,"暂无数据")):(0,a.kq)("",!0)])),B.isEdit?((0,a.wg)(),(0,a.iD)("div",we,[(0,a._)("div",ye,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(B.form.image,((e,t)=>((0,a.wg)(),(0,a.iD)("div",{class:"img",key:t},[(0,a._)("img",{src:e,alt:""},null,8,fe),(0,a._)("i",{class:"erp erpguanbi",onClick:e=>b.removeImg(t)},null,8,ve)])))),128)),B.form.image.length<2?((0,a.wg)(),(0,a.iD)("div",_e,[B.uploading?(0,a.kq)("",!0):((0,a.wg)(),(0,a.iD)("input",{key:0,onChange:t[12]||(t[12]=(...e)=>b.uploadFile&&b.uploadFile(...e)),ref:"file",type:"file"},null,544)),B.uploading?(0,a.kq)("",!0):((0,a.wg)(),(0,a.iD)("p",ke,Ce)),B.uploading?(0,a.kq)("",!0):((0,a.wg)(),(0,a.iD)("p",Be,"点击上传照片")),B.uploading?((0,a.wg)(),(0,a.j4)(De,{key:3,width:90,type:"circle",percentage:B.percentage},null,8,["percentage"])):(0,a.kq)("",!0)])):(0,a.kq)("",!0)])])):(0,a.kq)("",!0)]),(0,a._)("div",be,[Ue,(0,a._)("div",Ve,[(0,a.Wm)(R,{disabled:!B.isEdit,modelValue:B.form.workText,"onUpdate:modelValue":t[13]||(t[13]=e=>B.form.workText=e),placeholder:"请输入备注"},null,8,["disabled","modelValue"])])]),(0,a._)("div",xe,[$e,(0,a._)("div",ze,[(0,a._)("div",{class:"hjbox",style:(0,i.j5)({width:150*B.form.smartDevice.length+"px"})},[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(B.form.smartDevice,(e=>((0,a.wg)(),(0,a.iD)("div",{class:"huanjing",key:e.id},[(0,a._)("img",{src:b.getIconUrl(e.icon),alt:""},null,8,Te),(0,a._)("p",null,(0,i.zw)(e.value||" ")+(0,i.zw)(e.unit||" "),1),(0,a._)("p",null,(0,i.zw)(e.displayName),1)])))),128))],4),0==B.form.smartDevice.length?((0,a.wg)(),(0,a.iD)("p",Le,"暂无数据")):(0,a.kq)("",!0)])]),(0,a._)("div",Ne,[je,(0,a._)("div",Ie,[(0,a.kq)("",!0),Ee])])]),B.showChose?((0,a.wg)(),(0,a.j4)(qe,{key:0,onSave:b.save,onChose:b.chose,onClose:b.closeChose},null,8,["onSave","onChose","onClose"])):(0,a.kq)("",!0),B.showAddPests?((0,a.wg)(),(0,a.j4)(Ae,{key:1,type:B.addPestsType,onClose:b.closePests,onSave:b.savePests},null,8,["type","onClose","onSave"])):(0,a.kq)("",!0)])),_:1},8,["modelValue","title","before-close"])}var Ae=l(3483),Pe=l(8618),We=l(7987),Me={props:["title","id"],emits:["load","success","close"],data(){return{dialogVisible:!0,searchKey:"",list:[],imgs:[],form:{image:[],farmUseBos:[],smartDevice:[]},farmType:[],operatingType:[],isEdit:!1,uploading:!1,percentage:0,showChose:!1,showAddPests:!1,addPestsType:0}},components:{PlantCropsDetailBDialogChose:Pe.Z,PlantCropsDetailBDialogAddPests:We.Z},mounted(){let e=this,t=async function(){await e.getData(),await e.getFarmType(),await e.getOperatingType(),await e.getFarmRecordImg()};t()},computed:{imgSpace(){let e=0;return e=4-this.imgs.length%4,e}},methods:{saveGrowData(){this.isEdit=!1},addPests(e){this.showAddPests=!0,this.addPestsType=e},savePests(e){e.type?this.form.farmDetailBo.farmDetailListChongBoList.push({count:e.num,farmDetailId:0,title:e.name,type:0}):this.form.farmDetailBo.farmDetailListTianBoList.push({count:e.num,farmDetailId:0,title:e.name,type:1})},closePests(){let e=setTimeout((()=>{this.showAddPests=!1,clearTimeout(e)}),500)},removePests(e,t){1==t?this.form.farmDetailBo.farmDetailListChongBoList.splice(e,1):this.form.farmDetailBo.farmDetailListTianBoList.splice(e,1)},viewImg(e){this.$nextTick((()=>{window.open(e)}))},getFarmRecordImg(){this.ajax.post("/api/v1/adam/task/getFarmRecordImg",{growPlantId:this.$route.query.id}).then((e=>{let t=[];e.data.map((e=>{e=e.split(","),t=[...t,...e]})),this.imgs=t}))},editButton(){if(this.isEdit){let e=JSON.parse(JSON.stringify(this.form));e.smartDevice=JSON.stringify(e.smartDevice),e.image=e.image.join(","),this.ajax.post("/api/v1/adam/farm/editeFarm",e).then((e=>{200==e.code?(this.$message.success("保存成功"),this.isEdit=!1,this.$emit("load")):this.$message.error("编辑失败，请稍后再试")}))}else this.isEdit=!0},closeChose(){setTimeout((()=>{this.showChose=!1}),300)},removeNz(e){this.form.farmUseBos.splice(e,1)},getIconUrl(e){return`https://cdn.deepberry.cn/img/common/node-props/${e||"default"}.svg`},chose(e){console.log(e);let t=[...this.form.farmUseBos,...e].map((e=>(e.agriculturalCount=Number(e.agriculturalCount),e)));var l=function(e){for(var t=[],l=[],a=0;a<e.length;a++)l.indexOf(e[a].agricultural)>-1?t[l.indexOf(e[a].agricultural)].agriculturalCount+=e[a].agriculturalCount:(l.push(e[a].agricultural),t.push(e[a]));return t};this.form.farmUseBos=l(t)},save(e){this.form.farmUseBos.push(e)},removeImg(e){console.log(e),this.form.image.splice(e,1)},uploadFile(){this.uploading=!0;let e=this.$refs.file.files[0];(0,Ae.Z)(e,`erp/farmingHistory/${e.name}`).then((e=>{e.url&&(this.form.image.push(e.url),this.uploading=!1,this.percentage=0)}))},del(){this.isEdit?(this.isEdit=!1,this.getData()):this.ajax.post("/api/v1/adam/farm/delFarmRecordById",{id:this.id}).then((e=>{200==e.code?(this.$message.success("删除成功"),this.handleClose(),this.$emit("load")):this.$message.error(e.message)}))},handleClose(){this.dialogVisible=!1,this.$emit("close")},getData(){return new Promise(((e,t)=>{this.ajax.post("/api/v1/adam/farm/getFarmRecordById",{id:this.id}).then((t=>{t.data.image=t.data.image.length>0?t.data.image.split(","):[],t.data.smartDevice=JSON.parse(t.data.smartDevice)||[],t.data.farmDetailBo=t.data.farmDetailBo||{farmDetailListChongBoList:[],farmDetailListTianBoList:[],farmDetailListGrowBoList:[]},this.form=t.data,console.log(this.form),e()}))}))},getFarmType(){return new Promise(((e,t)=>{this.ajax.post("/api/v1/adam/farm/getFarmType").then((t=>{this.farmType=t.data,e()}))}))},getOperatingType(){return new Promise(((e,t)=>{this.ajax.post("/api/v1/adam/farm/getOperatingType").then((t=>{this.operatingType=t.data,e()}))}))}}},Fe=l(8118);const He=(0,Fe.Z)(Me,[["render",qe],["__scopeId","data-v-3080dee8"]]);var Se=He},2335:function(e,t){const l={to2:e=>Number(e)<10?`0${Number(e)}`:String(e),time(e="y-m-d",t=null){let l=t?new Date(t):new Date;return e=e.replace("y",l.getFullYear()),e=e.replace("m",this.to2(l.getMonth()+1)),e=e.replace("d",this.to2(l.getDate())),e=e.replace("h",this.to2(l.getHours())),e=e.replace("i",this.to2(l.getMinutes())),e=e.replace("s",this.to2(l.getSeconds())),e=e.replace("w",l.getDay()),e},monthLength(e=null){let t=1*this.time("y",e),l=this.to2(1*this.time("m",e)+1);if(13==l)return 31;{let e=new Date(`${t}-${l}-01`).getTime()-864e5;return Number(this.time("d",e))}},preMonthLenggth(e=null){let t=1*this.time("y",e),l=this.to2(1*this.time("m",e)),a=new Date(`${t}-${l}-01`).getTime()-864e5;return Number(this.time("d",a))},nextMonthLenggth(e=null){let t=1*this.time("y",e),l=this.to2(1*this.time("m",e)+2),a=new Date(`${t}-${l}-01`).getTime()-864e5;return Number(this.time("d",a))},monthFirst(e=null){let t=this.time("y-m",e)+"-01";return this.time("y-m-d",t)},monthLast(e=null){let t=1*this.time("y",e),l=this.to2(1*this.time("m",e)+1),a=new Date(`${t}-${l}-01`).getTime()-864e5;return this.time("y-m-d",a)},preMonthToday(e=null){let t=Number(e.substr(0,4)),l=Number(e.substr(5,2)),a=Number(e.substr(8));return a>this.preMonthLenggth(`{y}-${l}-01`)&&(a=this.preMonthLenggth(`{y}-${l}-01`)),1==l?(t-=1,l=12):l-=1,`${t}-${l}-${a}`},nextMonthToday(e=null){let t=Number(e.substr(0,4)),l=Number(e.substr(5,2)),a=Number(e.substr(8));return a>this.nextMonthLenggth(`{y}-${l}-01`)&&(a=this.nextMonthLenggth(`{y}-${l}-01`)),12==l?(t+=1,l=1):l+=1,`${t}-${l}-${a}`},timeout(e){},timeRemaining(e,t){return t-=parseInt((new Date).getTime()/1e3),this.unixToString(e,t)},unixToString(e,t){let a=parseInt(t/60/60/24),i=parseInt((t-86400*a)/3600),s=parseInt((t-86400*a-3600*i)/60),o=t-86400*a-3600*i-60*s;return e=e.replace("d",l.to2(l.low(a))),e=e.replace("h",l.to2(l.low(i))),e=e.replace("i",l.to2(l.low(s))),e=e.replace("s",l.to2(l.low(o))),e},low(e){return e<0?0:e},parse(e){return new Date(e)}};t["Z"]=l}}]);
//# sourceMappingURL=231.f5dcf5ab.js.map